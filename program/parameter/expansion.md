# 参数扩展

#### 什么是参数扩展？

它比听起来简单的多。意思是为了从一些变量中获取值，你只要在前面加上`$`。也就是，`$PWD`代表变量`PWD`的值。

重要的是，你要知道还有更多有用的方法来代替变量的值。我们在下面回顾`zsh`的扩展机制。

接下来我们会讨论一些可以用来改变`zsh`扩展变量的标志。

### 参数扩展的形式

---

形式：`${VAR}`

这实际上是`$VAR`的替代形式。`VAR`的值会被替代，如果存在的话。

如果`VAR`后面跟着一个你并不想作为名字的一部分的字母，则**必须**使用大括号。

实例：

```shell
  lyric[127]: NAME=Larry
  lyric[128]: echo $NAMED
  
  lyric[129]: echo ${NAME}D
  LarryD
```

---

形式：`${+VAR} `

如果变量`VAR`存在，则返回`1`；否则，返回`0`。

---

形式：`${VAR:-word} `

如果变量`VAR`存在并且非空，像往常一样显示。否则，显示`word`。

---

形式：`${VAR:=word} `

如果变量`VAR`未指定或为空，则将其指定为`word`，否则，返回`word`。

---

形式：`${VAR:?word} `

如果变量`VAR`存在并且非空，则返回它的值。否则，打印`word`并退出当前命令或脚本。

---

形式：`${VAR:+word} `

如果`VAR`存在并非空，则返回`word`。否则，什么都不返回。

---

**注意**：上面的表达式都带有一个冒号。如果删除了冒号，`zsh`只会检查变量是否存在，并**不在意**它是否为空。

---

形式：`${VAR::=word} `

设置`VAR`为`word`。然后返回这个参数的值。这和`:=`相似，不过它**强制**赋值。

---

形式：`${name#pattern} ` `${name##pattern} `

如果`pattern`匹配`name`的开始，返回未匹配的部分。如果没有匹配，直接返回`name`。

第一种形式为最小匹配。（非贪婪模式）第二种形式为贪婪模式，最大的匹配模式是首选。（贪婪模式）

---

形式：`${name%pattern} ` `${name%%pattern} `

和上面的形式相似，不过匹配的是**末端**。

---

形式：`${name:#pattern} `

如果模式`pattern`匹配`name`，则代表空字符串。否则，显示`name`。

如果`name`是一个数组，匹配的数组元素被删除。使用`M`标志删除不匹配的元素。

如果`name`是一个数组，则在数组的每个元素分别执行如果替换未被引用，使用标志`@`或`name[@]`。

---

形式：`${#sub} `

`sub`可以是上面的任何代替。但是会返回结果的字符长度，而不是结果本身。如果`sub`是一个数组表达式，则代替结果的元素数目。